# Release Guide - EliteMeritTracker

## How to Create a Release with systems-game-data.json

Follow these steps carefully when creating a new release to ensure the large game data file is properly attached.

### Prerequisites
- Your `system_data/systems-game-data.json` file is up-to-date locally
- All code changes are committed and pushed to GitHub
- You're ready to tag a new version

---

## Step-by-Step Release Process

### 1. Tag Your Version
```bash
git tag v0.4.300.1.XXX
git push origin v0.4.300.1.XXX
```

### 2. Go to GitHub Releases Page
Navigate to: `https://github.com/Fumlop/EliteMeritTracker/releases`

### 3. Click "Draft a new release"

### 4. Fill in Release Details
- **Choose a tag**: Select the tag you just pushed (e.g., `v0.4.300.1.XXX`)
- **Release title**: Version number (e.g., `v0.4.300.1.XXX`)
- **Description**: Add release notes describing changes

### 5. **CRITICAL: Compress and Attach systems-game-data.json**

⚠️ **DO NOT SKIP THIS STEP** ⚠️

**First, compress the file:**

Option A - Using 7-Zip (Windows):
1. Right-click `system_data/systems-game-data.json`
2. 7-Zip → Add to archive...
3. Archive format: `gzip`
4. Archive name: `systems-game-data.json.gz`
5. Click OK

Option B - Using Command Line:
```bash
# Windows (PowerShell)
gzip -k system_data/systems-game-data.json

# This creates: system_data/systems-game-data.json.gz
```

**Then, attach to release:**
1. Scroll down to the **"Attach binaries by dropping them here or selecting them"** section
2. Click to browse or drag-and-drop the file
3. Navigate to: `system_data/systems-game-data.json.gz` (the compressed file)
4. Select and upload the file

**The file MUST be named exactly:** `systems-game-data.json.gz`

### 6. Choose Release Type
- **Uncheck** "Set as a pre-release" for stable releases
- **Check** "Set as a pre-release" for beta versions

### 7. Publish Release
Click **"Publish release"**

---

## Verification Checklist

After publishing, verify your release includes:

✅ **Source code (zip)** - Auto-generated by GitHub
✅ **Source code (tar.gz)** - Auto-generated by GitHub
✅ **systems-game-data.json.gz** - Manually attached by you (~5-10MB compressed)

If you see all three items in the "Assets" section, the release is correct!

---

## What Happens During Auto-Update

When users click "Update Available":

1. Plugin downloads the repository ZIP (code only)
2. Extracts code to plugin folder
3. **Separately downloads `systems-game-data.json.gz` from release assets**
4. **Decompresses it automatically**
5. Saves decompressed file to `system_data/systems-game-data.json`

The auto-update logic will:
- ✅ Preserve user data in `data/` folder
- ✅ Update all code files
- ✅ Download compressed game data file (faster download)
- ✅ Automatically decompress and overwrite `systems-game-data.json` with latest version
- ⚠️ Skip the download gracefully if the file isn't attached (logs warning)

---

## Troubleshooting

### "I forgot to attach the file!"
1. Edit the release on GitHub
2. Scroll to Assets section
3. Click "Edit release"
4. Attach the file
5. Click "Update release"

### "The file has the wrong name"
Delete the wrongly named file and re-upload with exact name: `systems-game-data.json.gz`

### "Users report missing game data"
Check that the file appears in the release's Assets section. If not, edit the release and attach it.

---

## File Location Reference

**Local Development:**
```
C:\Users\waldp\AppData\Local\EDMarketConnector\plugins\EliteMeritTracker\
└── system_data/
    ├── systems-game-data.json      ← Source file (40MB)
    └── systems-game-data.json.gz   ← Compress this and attach to release (~5-10MB)
```

**Git Status:**
- Both files are in `.gitignore` (won't be committed)
- `.gz` file must be manually compressed and attached to each release

---

## Quick Checklist

Before publishing a release:

- [ ] Code committed and pushed to GitHub
- [ ] Version tag created and pushed
- [ ] Release notes written
- [ ] **Compressed systems-game-data.json to .gz format**
- [ ] **systems-game-data.json.gz attached to release**
- [ ] Pre-release checkbox set correctly
- [ ] Release published
- [ ] Verified 3 assets appear (2 source + 1 game data .gz)
